@using BlazorLib.Components.StockSharp
@using SharedLib

@inherits StockSharpAboutComponent

@{
    string _opClass = Available ? "" : "opacity-25";
}

@if (IsBusyProgress)
{
    <MudTd colspan="11" DataLabel="Loading"><MudProgressLinear Color="Color.Primary" Indeterminate="true" Class="my-3" /></MudTd>
}
else
{
    <MudTd DataLabel="Bond" Class="@_opClass" title="@Instrument.Name">
        <code class="me-2">
            @if (NameInstrumentVisible)
            {
                <u class="me-2">@Instrument.Code</u>
                <text>@Instrument.Name</text>
            }
            else
            {
                <text>@Instrument.Code</text>
            }
        </code>
        @if (Instrument.Markers is not null && Instrument.Markers.Count != 0)
        {
            foreach (MarkerInstrumentStockSharpViewModel _ie in Instrument.Markers)
            {
                string colorClass = _ie.MarkerDescriptor switch
                {
                    (int)MarkersInstrumentStockSharpEnum.Illiquid => "warning",
                    (int)MarkersInstrumentStockSharpEnum.IsNew => "info",
                    (int)MarkersInstrumentStockSharpEnum.IsDisabled => "secondary",
                    (int)MarkersInstrumentStockSharpEnum.IsFavorite => "success",
                    (int)MarkersInstrumentStockSharpEnum.IsMarketMaker => "primary",
                    _ => "danger",
                };
                <span class="badge text-bg-@colorClass me-1">@(((MarkersInstrumentStockSharpEnum)_ie.MarkerDescriptor).DescriptionInfo())</span>
            }
        }
    </MudTd>
    <MudTd DataLabel="Price" Class="@($"trade-instrument-{Instrument.Id}-row")"><input @bind-value="BasePrice" type="number" class="form-control form-control-sm" @bind-value:event="oninput"></MudTd>
    <MudTd DataLabel="Volume"><input @bind-value="ValueOperation" type="number" class="form-control form-control-sm" @bind-value:event="oninput"></MudTd>
    <MudTd Class="@_opClass" DataLabel="Actions">
        <OperationsButtonsStockSharpComponent Available=Available InstrumentId=Instrument.Id @ref=OperationsButtonsRef />
    </MudTd>
    <MudTd DataLabel="SBV" Class="@($"trade-instrument-{Instrument.Id}-row")">
        <input @bind-value="SmallBidVolume" type="number" class="form-control form-control-sm" @bind-value:event="oninput">
    </MudTd>
    <MudTd DataLabel="SOV" Class="@($"trade-instrument-{Instrument.Id}-row")">
        <input @bind-value="SmallOfferVolume" type="number" class="form-control form-control-sm" @bind-value:event="oninput">
    </MudTd>
    <MudTd DataLabel="SO">
        <input @bind-value="SmallOffset" type="number" class="form-control form-control-sm" @bind-value:event="oninput">
    </MudTd>
    <MudTd DataLabel="WV" Class="@($"trade-instrument-{Instrument.Id}-row")">
        <input @bind-value="WorkingVolume" type="number" class="form-control form-control-sm" @bind-value:event="oninput">
    </MudTd>
    <MudTd DataLabel="Shift">
        <input @bind-value="Offset" type="number" class="form-control form-control-sm" @bind-value:event="oninput">
    </MudTd>
    <MudTd DataLabel="Confines" Class="@($"trade-instrument-{Instrument.Id}-row")">
        <div class="input-group input-group-sm">
            <div class="input-group-text">
                <label class="form-check-label me-1">
                    is small
                </label>
                <input @bind="IsSmall" class="form-check-input mt-0" type="checkbox" title="is small">
            </div>
            <span title="Low Limit" class="input-group-text">LL</span>
            <input title="Low Limit" @bind-value="LowLimit" type="number" class="form-control" @bind-value:event="oninput">
            <span title="Hight Limit" class="input-group-text">HL</span>
            <input title="Hight Limit" @bind-value="HightLimit" type="number" class="form-control" @bind-value:event="oninput">
        </div>
    </MudTd>
    <MudTd Class="@_opClass">
        <div class="input-group input-group-sm">
            <button @onclick=ResetTrade title="reset" disabled="@(!Available)" class="btn btn-outline-success bi bi-recycle @($"trade-instrument-{Instrument.Id}-row")" type="button"></button>
        </div>
    </MudTd>
}